name: Android Tests

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    build:
        name: Run Unit & UI Tests
        runs-on: ubuntu-latest

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Setup JDK 17
              uses: actions/setup-java@v4
              with:
                  distribution: temurin
                  java-version: 17

            - name: Grant execute permission to Gradle
              run: chmod +x ./gradlew

            - name: Run unit tests
              run: ./gradlew testDebugUnitTest

            - name: Run instrumented tests
              uses: reactivecircus/android-emulator-runner@v2
              with:
                  api-level: 31
                  script: ./gradlew connectedCheck
